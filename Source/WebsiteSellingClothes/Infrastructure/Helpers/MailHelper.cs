using Microsoft.Extensions.Configuration;
using System.Diagnostics;
using System.Net;
using System.Net.Mail;


namespace Infrastructure.Helplers;
public class MailHelper
{
    private IConfiguration configuration;

    public MailHelper(IConfiguration _configuration)
    {
        configuration = _configuration;
    }

    public bool Send(string from, string to, string subject, string body)
    {
        try
        {
            var host = configuration["Gmail:Host"];
            var port = int.Parse(configuration["Gmail:Port"]);
            var username = configuration["Gmail:Username"];
            var password = configuration["Gmail:Password"];
            var enable = bool.Parse(configuration["Gmail:SMTP:starttls:enable"]);
            var smtpClient = new SmtpClient
            {
                Host = host,
                Port = port,
                EnableSsl = enable,
                Credentials = new NetworkCredential(username, password)
            };

            var mailMessage = new MailMessage(from, to);
            mailMessage.Subject = subject;
            mailMessage.Body = body;
            mailMessage.IsBodyHtml = true;
			smtpClient.Send(mailMessage);

            return true;
        }
        catch(Exception ex)
        {
            Debug.WriteLine("Email---------"+ ex);
            return false;
        }
    }
    public static string HtmlVerify(string code)
    {
        return "\r\n    <table style=\"background-color:#fff;border:0;border-collapse:collapse;border-color:#ddd;border-spacing:0;border-style:solid;border-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0 auto;max-width:680px;padding:0;text-align:center;vertical-align:baseline;width:100%\">\r\n        <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                <td style=\"border:0;border-bottom-color:#ddd;border-bottom-style:solid;border-bottom-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                    <div style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:20px;padding:0;vertical-align:baseline\">\r\n                        <img width=\"119\" height=\"35\" style=\"border:0;border-style:none;box-sizing:inherit;font:inherit;font-size:100%;margin:0;outline:none;padding:0;text-decoration:none;vertical-align:baseline\" src=\"https://iili.io/JWj8Ja9.png\" >\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\">\r\n                    <table style=\"border:0;border-collapse:collapse;border-spacing:0;box-sizing:inherit;display:inline-block;font:inherit;font-size:100%;margin:0;padding:10px 20px;text-align:center;vertical-align:baseline;width:unset\">\r\n                        <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                <td style=\"border:0;border-bottom-color:#ddd;border-bottom-style:solid;border-bottom-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\">\r\n                                    <table style=\"border:0;border-collapse:collapse;border-spacing:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;max-width:558px;padding:0;text-align:center;vertical-align:baseline;width:100%\">\r\n                                        <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                                <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:60px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                    <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:20px;font-weight:bold;line-height:20px;margin:0;padding:0;vertical-align:baseline\">Verify your email address</p>\r\n                                                </td>\r\n                                            </tr>\r\n                                            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                                <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:50px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                    <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:14px;font-weight:300;line-height:20px;margin:0;padding:0;vertical-align:baseline\">You need to verify your email address to continue using your account. Enter the following code to verify your email address:</p>\r\n                                                </td>\r\n                                            </tr>\r\n                                            <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                                <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:60px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                    <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:20px;font-weight:bold;line-height:20px;margin:0;padding:0;vertical-align:baseline\">\r\n                                                        <span id=\"m_-8483616267167387556verification-code\">" + code+"</span>\r\n                                                    </p>\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n   ";
    }
    public static string HtmlNewAccount(string fullname,string username, string password)
    {
        return "\r\n<table style=\"background-color:#fff;border:0;border-collapse:collapse;border-color:#ddd;border-spacing:0;border-style:solid;border-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0 auto;max-width:680px;padding:0;text-align:center;vertical-align:baseline;width:100%\">\r\n    <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n            <td style=\"border:0;border-bottom-color:#ddd;border-bottom-style:solid;border-bottom-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                <div style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:20px;padding:0;vertical-align:baseline\">\r\n                    <img width=\"119\" height=\"35\" style=\"border:0;border-style:none;box-sizing:inherit;font:inherit;font-size:100%;margin:0;outline:none;padding:0;text-decoration:none;vertical-align:baseline\" src=\"https://iili.io/JWj8Ja9.png\" alt=\"\" class=\"\" data-bit=\"\">\r\n                </div>\r\n            </td>\r\n        </tr>\r\n        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n            <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\">\r\n                <table style=\"border:0;border-collapse:collapse;border-spacing:0;box-sizing:inherit;display:inline-block;font:inherit;font-size:100%;margin:0;padding:10px 20px;text-align:center;vertical-align:baseline;width:unset\">\r\n                    <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                            <td style=\"border:0;border-bottom-color:#ddd;border-bottom-style:solid;border-bottom-width:1px;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:middle\">\r\n                                <table style=\"border:0;border-collapse:collapse;border-spacing:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;max-width:558px;padding:0;text-align:center;vertical-align:baseline;width:100%\">\r\n                                    <tbody style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                            <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:60px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:20px;font-weight:bold;line-height:20px;margin:0;padding:0;vertical-align:baseline\">Hello " + fullname+"</p>\r\n                                            </td>\r\n                                        </tr>\r\n                                        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                            <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:50px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:14px;font-weight:300;line-height:20px;margin:0;padding:0;vertical-align:baseline\">We are happy that you have chosen and trusted our company. Below is your account and temporary password.</p>\r\n                                            </td>\r\n                                        </tr>\r\n                                        <tr style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline\">\r\n                                            <td style=\"border:0;box-sizing:inherit;font:inherit;font-size:100%;height:60px;margin:0;padding:0;vertical-align:middle\" align=\"left\">\r\n                                                <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:20px;font-weight:bold;line-height:20px;margin:0;padding:0;vertical-align:baseline\">\r\n                                                    <span id=\"m_-8483616267167387556verification-code\">Username : "+username+"</span> \r\n                                                </p>\r\n                                                <p style=\"border:0;box-sizing:inherit;color:rgb(34,34,34);font:inherit;font-size:20px;font-weight:bold;line-height:20px;margin:0;padding:0;vertical-align:baseline;margin-top: 10px;\">\r\n                                                    <span id=\"m_-8483616267167387556verification-code\">Password : "+password+"</span> \r\n                                                </p>\r\n                                            </td>\r\n                                        </tr>\r\n                                    </tbody>\r\n                                </table>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table>\r\n";
    }
 
}
